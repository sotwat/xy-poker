.app {
  text-align: center;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

.app-header {
  background: #2c3e50;
  color: white;
  padding: 0.3rem;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  /* Removed position: relative; now relying on children */
}

.header-title-row {
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  min-height: 1.5rem;
  /* Ensure specific height for alignment */
}

.app-header h1 {
  font-size: 1rem;
  margin: 0;
  text-align: center;
}

.app-header .version {
  position: absolute;
  right: 0.2rem;
  top: 50%;
  transform: translateY(-50%);
  font-size: 0.6rem;
  color: #888;
  font-weight: normal;
}

/* Remove the rule that hid version in non-lobby views */
/* .app:not(.view-lobby) .version { display: none !important; } */

.btn-fullscreen {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: #fff;
  width: 36px;
  height: 36px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  cursor: pointer;
  margin-left: auto;
  margin-right: 10px;
  backdrop-filter: blur(5px);
  transition: all 0.2s;
}

.btn-fullscreen:hover {
  background: rgba(255, 255, 255, 0.2);
  transform: scale(1.05);
}

.btn-fullscreen:active {
  transform: scale(0.95);
}

/* Hide header when result screen is shown */
body:has(.game-result-overlay) .app-header {
  display: none;
}

.game-board {
  flex: 1;
  padding: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
}

.play-area {
  display: flex;
  flex-direction: column;
  gap: 32px;
  width: 100%;
  max-width: none;
  transform: scale(0.8);
  transform-origin: center center;
  margin-top: -90px;
  /* Raised field position on PC */
}

.opponent-area,
.player-area {
  background: white;
  padding: 16px;
  border-radius: 12px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
}

.opponent-area {
  opacity: 0.9;
  transform: scale(0.95);
}

.opponent-area .board {
  transform: rotate(180deg);
}

/* Rotate cards back so they are upright for the viewer? 
   Or keep them upside down as if viewed from across? 
   "Face each other across dice".
   Usually in digital card games, opponent cards are upside down or upright.
   If we rotate the board 180, the "Top Row" (Row 0) becomes the bottom visually.
   Row 2 (X Hand) becomes top visually.
   Wait, Row 0 is top.
   If we rotate 180:
   Row 0 is now at bottom.
   Row 2 is at top.
   The Dice are attached to the board columns.
   If we rotate the WHOLE board, the dice also rotate to the bottom?
   My Board component has Dice at the top.
   If I rotate 180, Dice go to bottom.
   This creates:
   [Opponent Row 2]
   [Opponent Row 1]
   [Opponent Row 0]
   [Opponent Dice]
   
   [Player Dice] (if Player board is normal)
   [Player Row 0]
   [Player Row 1]
   [Player Row 2]
   
   This puts the dice in the middle! This is exactly what "Across the dice" means.
   Perfect.
   
   Now, card orientation.
   If board is rotated 180, cards are also rotated 180 (upside down).
   This is realistic.
   But maybe hard to read.
   Let's keep them upside down for "immersion" or rotate them back?
   User said "Face each other".
   I'll keep them rotated with the board (upside down for me).
   Actually, let's rotate the CONTENT of the card back if we want readability.
   But "Facing each other" implies I see their backs or upside down faces.
   Since it's open info (mostly), upside down is fine.
   But let's make the text readable?
   No, let's stick to pure board rotation first.
*/

.controls {
  background: white;
  padding: 8px;
  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
  position: sticky;
  bottom: 0;
}

.hand-container {
  margin-bottom: 8px;
  display: flex;
  justify-content: center;
}

.action-bar {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 10px;
  min-height: 30px;
  font-size: 0.85rem;
}

.btn-primary {
  background: #007bff;
  color: white;
  border: none;
  padding: 12px 24px;
  font-size: 1.1rem;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.2s;
}

.btn-primary:hover {
  background: #0056b3;
}

.btn-secondary {
  background: #28a745;
  color: white;
  border: none;
  padding: 12px 24px;
  font-size: 1.1rem;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.2s;
}

.btn-secondary:hover {
  background: #1e7e34;
}

.btn-secondary:disabled {
  background: #6c757d;
  cursor: not-allowed;
  opacity: 0.6;
}

.toggle-hidden {
  display: flex;
  align-items: center;
  gap: 8px;
  font-weight: bold;
  cursor: pointer;
  user-select: none;
  color: black;
  white-space: nowrap;
}

.instruction {
  color: #666;
  font-style: italic;
  min-height: 1.2em;
  display: block;
}

@media (max-width: 900px) {
  .instruction {
    width: 100%;
    text-align: center;
  }
}

.setup-screen {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
}

/* Mobile Optimization: Fit to Screen */
/* Mobile Optimization: Fit to Screen */
/* Mobile Optimization: Fit to Screen */
/* Mobile Optimization: Fit to Screen */
@media (max-width: 900px) {
  .app {
    height: 100dvh;
    /* Force full viewport height */
    overflow: hidden;
    /* Prevent scrolling */
    display: flex;
    flex-direction: column;
    justify-content: center;
    /* Center content */
    gap: 0;
  }

  .app-header {
    padding: 0.2rem 0.2rem 0 0.2rem;
    /* Remove bottom padding */
    flex-shrink: 0;
    z-index: 20;
  }

  .app-header h1 {
    font-size: 1rem;
    margin: 0;
    /* Remove margin */
    line-height: 1.2;
  }

  .game-board {
    flex: 1;
    /* Take all available space */
    padding: 0;
    padding-top: 20px;
    /* Minimal top padding */
    min-height: 0;
    /* Allow shrinking */
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    /* Center content */
  }

  .play-area {
    gap: 0;
    /* Remove gap completely */
    width: 100%;
    /* Full width */
    transform: scale(0.63) translateY(-115px);
    transform-origin: center center;
    /* Center anchor */
    margin: 0;
    padding: 0;
    flex: 0 0 auto;
    /* Don't grow/shrink */
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .controls {
    padding: 5px;
    /* Minimal padding */
    flex-shrink: 0;
    /* Don't shrink controls */
    background: rgba(255, 255, 255, 0.95);
    z-index: 10;
    /* Ensure on top */
    width: 100vw;
    /* Full viewport width */
    box-sizing: border-box;
    /* Include padding in width */
    position: relative;
    bottom: 110px;
    /* Controls position - raised by 10px */
  }

  .action-bar {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    margin-top: 5px;
  }

  .place-controls {
    display: flex;
    justify-content: center;
    width: 100%;
  }

  .toggle-hidden {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 2px;
    /* Minimal gap */
    white-space: nowrap;
    font-size: 0.8rem;
    background: rgba(255, 255, 255, 0.9);
    padding: 6px 12px;
    border-radius: 20px;
    max-width: 95vw;
  }

  .toggle-hidden input {
    margin: 0;
    padding: 0;
  }

  /* Hide header during battle on mobile */
  .app-header.battle-mode {
    display: none !important;
  }
}

.waiting-message {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 1rem;
  padding: 2rem;
  background: rgba(255, 255, 255, 0.9);
  border-radius: 12px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.waiting-message h3 {
  margin: 0;
  color: #333;
}

.loading-spinner {
  width: 24px;
  height: 24px;
  border: 3px solid #ddd;
  border-top-color: #007bff;
  border-radius: 50%;
  animation: spinner 0.8s linear infinite;
}

@keyframes spinner {
  to {
    transform: rotate(360deg);
  }
}



/* Mode Switcher in Header */
.mode-switch {
  display: flex;
  gap: 10px;
  justify-content: center;
  margin-top: 5px;
}

.mode-switch button {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.3);
  color: #ccc;
  padding: 4px 12px;
  font-size: 0.8rem;
  border-radius: 15px;
  cursor: pointer;
  transition: all 0.2s;
}

.mode-switch button:hover {
  background: rgba(255, 255, 255, 0.2);
  color: white;
}

.mode-switch button.active {
  background: #3498db;
  border-color: #3498db;
  color: white;
  font-weight: bold;
  box-shadow: 0 0 5px rgba(52, 152, 219, 0.5);
}

.auth-status {
  position: absolute;
  top: 10px;
  right: 10px;
  z-index: 50;
}

.btn-auth {
  padding: 6px 12px;
  background: #4da8da;
  border: none;
  color: #000;
  border-radius: 4px;
  font-weight: bold;
  cursor: pointer;
  font-size: 1rem;
}

@media (max-width: 900px) {
  .auth-status {
    top: 2px;
    right: 2px;
  }

  .btn-auth {
    padding: 10px 4px;
    /* More vertical, less horizontal */
    font-size: 0.65rem;
    line-height: 1.1;
    white-space: break-spaces;
    /* Allow text to wrap if needed */
    max-width: 60px;
    /* Constrain width to force stacked look if possible/needed */
    text-align: center;
  }
}


/* Ad Banner Container */
.ad-banner-container {
  width: 100%;
  height: 50px;
  /* Standard mobile banner height */
  background-color: #f0f0f0;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-top: 2rem;
  border-radius: 4px;
}

/* Modal Overlay (Rematch, etc) */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
  /* Ensure it's on top of everything including GameResult */
}

.modal-content {
  background: white;
  padding: 2rem;
  border-radius: 16px;
  text-align: center;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
  max-width: 90%;
  width: 320px;
  animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.modal-content h3 {
  margin-top: 0;
  color: #2c3e50;
}

.modal-actions {
  display: flex;
  justify-content: center;
  gap: 1rem;
  margin-top: 1.5rem;
}

@keyframes popIn {
  from {
    transform: scale(0.8);
    opacity: 0;
  }

  to {
    transform: scale(1);
    opacity: 1;
  }
}

/* Finish Animation */
.finish-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.4);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10000;
  pointer-events: none;
}

.finish-text {
  font-size: clamp(3rem, 15vw, 6rem);
  text-align: center;
  width: 100%;
  font-weight: 900;
  color: #ffcc00;
  /* Gold */
  text-shadow: 0 0 20px rgba(0, 0, 0, 0.5), 0 0 10px white;
  animation: finishPop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
  letter-spacing: 0.5rem;
}

@keyframes finishPop {
  0% {
    transform: scale(0) rotate(-10deg);
    opacity: 0;
  }

  60% {
    transform: scale(1.2) rotate(5deg);
    opacity: 1;
  }

  100% {
    transform: scale(1) rotate(0deg);
    opacity: 1;
  }
}

.active-auto {
  animation: pulse-red 1.5s infinite;
}

@keyframes pulse-red {
  0% {
    box-shadow: 0 0 0 0 rgba(233, 30, 99, 0.7);
  }

  70% {
    box-shadow: 0 0 0 10px rgba(233, 30, 99, 0);
  }

  100% {
    box-shadow: 0 0 0 0 rgba(233, 30, 99, 0);
  }
}